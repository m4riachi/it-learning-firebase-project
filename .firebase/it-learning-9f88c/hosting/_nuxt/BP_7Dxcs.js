import{F as E,a as L}from"./CLZrmjW9.js";import{_ as C}from"./YAroTRNn.js";import{e as S,u as R,a7 as z,a8 as A,h as K,r as f,i as M,c as v,b as n,w as x,K as l,B as V,A as w,o as c,a as e,L as j,t as G,z as P,a9 as $,aa as q,ab as H,P as D,C as I}from"./V3PcRQWG.js";import{t as N,a as J}from"./BPUVw4Yf.js";import"./gnPeoup1.js";import"./RGmgZce_.js";const T={class:"min-h-full bg-gray-50 py-12"},O={class:"mx-auto max-w-3xl px-6 lg:px-8"},Q={class:"bg-white px-6 py-12 shadow sm:rounded-lg sm:px-12"},W={class:"space-y-12"},X={class:"pb-12"},Y={class:"mt-10 flex flex-col gap-y-8"},Z={class:"mt-4 flex items-center gap-x-6"},ee=["src"],te={key:1,class:"flex h-24 w-24 items-center justify-center rounded-full bg-gray-100"},se={class:"grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6"},ae={class:"sm:col-span-3"},oe={class:"sm:col-span-3"},le={class:"sm:col-span-3"},ie={class:"mt-8 flex"},re=["disabled"],ne={key:1},ge=S({__name:"profile",setup(de){var b;const g=R(),B=z(),y=A(),a=K(()=>g==null?void 0:g.currentUser),r=f(!1),h=f(((b=a.value)==null?void 0:b.photoURL)||""),_=f(null),p=f(!1),F=async()=>{var o,t;if((o=a.value)!=null&&o.uid){p.value=!0;try{const s=await V(w(y,"users",a.value.uid));console.log((t=s.data())==null?void 0:t.birthDate),s.exists()&&(_.value=s.data())}catch(s){console.error("Error fetching user data:",s)}finally{p.value=!1}}};M(()=>{F()});const U=async o=>{var s,m,d;const t=(m=(s=o==null?void 0:o.target)==null?void 0:s.files)==null?void 0:m[0];if(!(!t||!((d=a.value)!=null&&d.uid)))try{r.value=!0;const i=$(B,`profile-photos/${a.value.uid}`);await q(i,t);const u=await H(i);h.value=u,await D(a.value,{photoURL:u})}catch(i){N("","Error uploading profile photo"),console.error("Error:",i)}finally{r.value=!1}},k=async o=>{var t;if((t=a.value)!=null&&t.uid)try{r.value=!0,await D(a.value,{displayName:o.displayName}),await I(w(y,"users",a.value.uid),{displayName:o.displayName,birthDate:o.birthDate,email:a.value.email,updatedAt:new Date},{merge:!0}),J("Success","Profile updated successfully")}catch(s){N("","Error updating profile"),console.error("Error:",s)}finally{r.value=!1}};return(o,t)=>{const s=L,m=C;return c(),v("div",T,[n(l(E),{"config-file":"true"},{default:x(()=>[e("div",O,[e("div",Q,[e("div",W,[e("div",X,[t[3]||(t[3]=e("h2",{class:"text-xl font-semibold leading-7 text-gray-900"},"Profile",-1)),t[4]||(t[4]=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"}," Update your personal information and profile photo. ",-1)),l(p)?P("",!0):(c(),j(s,{key:0,type:"form",actions:!1,onSubmit:k},{default:x(()=>{var d,i,u;return[e("div",Y,[e("div",null,[t[2]||(t[2]=e("h3",{class:"text-sm font-medium leading-6 text-gray-900"},"Profile photo",-1)),e("div",Z,[l(h)?(c(),v("img",{key:0,src:l(h),alt:"Profile photo",class:"h-24 w-24 rounded-full object-cover border border-black"},null,8,ee)):(c(),v("div",te,t[0]||(t[0]=[e("svg",{class:"h-12 w-12 text-gray-300",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z"})],-1)]))),e("div",null,[n(s,{type:"file",name:"photo",accept:"image/*",onChange:U}),t[1]||(t[1]=e("p",{class:"mt-1 text-xs text-gray-500"},"PNG, JPG, GIF up to 2MB",-1))])])]),e("div",se,[e("div",ae,[n(s,{type:"text",name:"displayName",label:"Full name",value:((d=l(a))==null?void 0:d.displayName)||"",validation:"required"},null,8,["value"])]),e("div",oe,[n(s,{type:"email",name:"email",label:"Email",value:((i=l(a))==null?void 0:i.email)||"",disabled:""},null,8,["value"])]),e("div",le,[n(s,{type:"date",name:"birthDate",label:"Birth date",value:((u=l(_))==null?void 0:u.birthDate)||""},null,8,["value"])])])]),e("div",ie,[e("button",{type:"submit",disabled:l(r),class:"flex w-full justify-center rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},G(l(r)?"Saving...":"Save changes"),9,re)])]}),_:1})),l(p)?(c(),v("div",ne,"Please wait...")):P("",!0)])])])]),n(m)]),_:1})])}}});export{ge as default};
